# -*- jinx-languages: "es_ES"; -*-
#+title: Denote Funciones personalizadas
#+date: [2025-04-08 Tue 19:25]
#+filetags: :estudio:emacs:
#+identifier: 20250408T192555
#+author: Ing. Javier Pacheco
#+startup: showall

* Lista todos los links de la nota actual
Esta necesidad surgió mientras planificaba mi "sistema" de note-taking, al estar creando notas, después al agregarlas al archivo meta, se me hacia tedioso buscar nota por nota, o borrar toda la lista e insertar las notas de nuevo utilizando la función =denote-insert-links-matching-regexp=, por lo cual me decidí hacer esta función, que selecciona la lista dentro de un header lvl 1, lo borra y lanza el comando de denote.

#+begin_src emacs-lisp
(defun my/denote-or-org-link ()
  "Run `denote-find-link`. If nothing is inserted, show Org links in minibuffer."
  (interactive)
  (let ((before (buffer-substring-no-properties (point-min) (point-max))))
    (call-interactively #'denote-find-link)
    (run-at-time
     "0.1 sec" nil
     (lambda ()
       (let ((after (buffer-substring-no-properties (point-min) (point-max))))
         (when (string= before after)
           (let ((links (my/org-collect-links)))
             (if links
                 (let ((chosen (completing-read "Org links: " links)))
                   (when chosen
                     (kill-new chosen)
                     (message "Copied link to clipboard: %s" chosen)))
               (message "No Denote or Org links found.")))))))))

(defun my/org-collect-links ()
  "Collect all Org-style links ([[...]]) in the current buffer."
  (let (links)
    (save-excursion
      (goto-char (point-min))
      (while (re-search-forward org-link-bracket-re nil t)
        (push (match-string 0) links)))
    (delete-dups links)))
#+end_src
